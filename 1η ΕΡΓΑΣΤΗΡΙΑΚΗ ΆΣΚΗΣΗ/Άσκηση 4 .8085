NOP		;2 NOP για να μηδενιστούν οι θεσεις 0800H και 0801H
NOP ;****     ;η θέση 0800H υποθέτουμε οτι παίρνει τιμές 00H και FFH 
LXI H,0800H   ;όταν παίρνει την τιμή 00H τότε υποθέτουμε οτι κινήται προς τα αριστερά
		;ενώ όταν έχει την τιμή FFH υποθέτουμε ότι κινήται προς τα δεξιά
MVI A,0DH     ;ενεργοποίηση διακοπών
SIM 
EI 
             
MVI D,01H   ;Φορτωνω στον καταχωρητή D το 01H που είναι ο καταχωρητής που δηλώνει την κίνηση
IN 10H      
LXI B,01F4H  ;BC=01F4H=500->0,5sec για την χρονοκαθυστέρηση DELAY

LOOP1:     ;ΑΥΤΌ ΤΟ ΚΟΜΜΑΤΙ ΤΟΥ ΚΩΔΙΚΑ ΧΡΕΙΑΖΕΤΑΙ ΩΣΤΕ ΣΤΗΝ ΑΡΧΗ ΝΑ ΑΝΑΨΕΙ ΚΑΙ ΤΟ MSB 
IN 20H     ;Φορτωνω την εισοδο
RRC        ;δεξιά ολίσθηση ώστε να ελέγξουμε το LSB 
JNC LOOP1  ;αν είναι OFF τότε περιμένουμε την ενεργοποίησή του
MVI A,01H  ;εμφάνισε το 00000001
CMA
STA 3000H

LEFT:
MVI M,00H  ;στην θέση μνήμης 0800H βάζω το 00H δηλαδή η κίνηση είναι προς τα αριστερά
CALL DELB  ;καλλώ την ρουτίνα χρονοκαθυστέρησης
IN 20H     ;Φορτωνω την εισοδο
RRC        ;δεξιά ολίσθηση ώστε να ελέγξουμε το LSB 
JNC LEFT   ;αν είναι OFF τότε περιμένουμε την ενεργοποίησή του
MOV A,M    ;έλεγχος της θέσης μνήμης 0800H που δηλώνει την φορά της κίνησης
CPI 00H    ;αν δεν είναι 00 τότε άλλαξε κατεύθυνση 
JNZ RIGHT
MOV A,D   ;Μετακινησε το περιεχομενο του καταχωρητή D στον καταχωρητή A
RLC 	   ;Ολισθηση προς τα αριστερα
CPI 01H   ;Ειναι το MSB ψηφιο ενα? Εχει φτασει στο 10000000 δηλαδη?
JZ RIGHT  ;Αν ναι τοτε πρεπει να γυρνανε τα LED προς τα πισω. Αυτο κανει η παραπανω ετικετα RIGHT
CMA 	   ;η έξοδος είναι αρνητικής λογικής
OUT 30H   ;εμφάνιση στην έξοδο
CMA 	   ;Συμπληρωμα του Α για να παρω το αρχικο περιεχομενο του 
MOV D,A   ;ανανέωσε τον καταχωρητή D
JMP LEFT  ;Ξανακαλεσε την ιδια διαδικασια


RIGHT:
MVI M,FFH  ;στην θέση μνήμης 0800H βάζω το FFH δηλαδή η κίνηση είναι προς τα δεξιά
CALL DELB  ;καλλώ την ρουτίνα χρονοκαθυστέρησης
IN 20H     ;Φορτωνω την εισοδο
RRC        ;δεξιά ολίσθηση ώστε να ελέγξουμε το LSB 
JNC RIGHT  ;αν είναι OFF τότε περιμένουμε την ενεργοποίησή του
MOV A,M    ;έλεγχος της θέσης μνήμης 0800H που δηλώνει την φορά της κίνησης
CPI 00H    ;αν είναι 00 τότε άλλαξε κατεύθυνση
JZ LEFT
MOV A,D   ;Μετακινησε το περιεχομενο του D στον Α
RRC 	   ;Ολισθηση προς τα δεξια
CPI 80H   ;Ειναι το LSB ψηφιο 1?Εχει φτασει δηλαδη στο 00000001?
JZ LEFT   ;Αν ναι τοτε πρεπει να πηγαινουν τα LED προς τα μπροστα. Οποτε καλουμε ξανα την ετικετα LEFT
CMA 	   ;η έξοδος είναι αρνητικής λογικής
OUT 30H   ;εμφάνιση στην έξοδο
CMA       ;Συμπληρωμα του Α για να παρω το αρχικο περιεχομενο του 
MOV D,A   ;ανανέωσε τον καταχωρητή D
JMP RIGHT ;Ξανακαλεσε την ιδια διαδικασια

INTR_ROUTINE: ;ορισμός ρουτίνας διακοπής
PUSH PSW 
LDA 0801H ;****  ;εδω έχουμε την περίπτωση για το κλικ (πάτημα και άφημα) να λαμβάνεται 
CPI 00H   ;****  ;ως μία διακοπή. αυτό το κάνουμε θεωρόντας ότι η τιμή της μνήμης 0801H 
JNZ END_ROUTINE ;****  ;παίρνει τις τιμές 00H όπου και μετράμε την διακοπή και την τιμή FFH όπου απιρρίπτει την διακοπή

      
LDA 2000H     ;έλεγχος για το LSM ώστε αν είναι OFF να αγνοήσει την διακοπή
ANI 01H
JZ END_ROUTINE 
MOV A,M       ;άλλαξε την τιμή της θέσης μνήμης 0800H δηλαδή άλλαξε την κατεύθυνση της κίνησης
CMA 		;αυτό επιτυγχάνεται με την συμπλήρωση της τιμής αυτής
MOV M,A
END_ROUTINE:
LDA 0801H ;****     ;συμπληρώνεται η τιμή της θέσης μνήμης 0801Η που ελέγχει αν η διακοπή θα προσμετρηθεί
CMA       ;****
STA 0801H ;****    
POP PSW 
EI           ;ενεργοποίηση διακοπών αφού απενεργοποιούνται αυτόματα
RET
		
END
